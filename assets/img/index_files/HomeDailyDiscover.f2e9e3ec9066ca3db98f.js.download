(("undefined"!=typeof self?self:this).webpackJsonp=("undefined"!=typeof self?self:this).webpackJsonp||[]).push([[76],{1401:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r=32,a={ALL:"ALL",CAMPAIGN:"CAMPAIGN",CATEGORY:"CATEGORY"}},1454:function(e,t,n){"use strict";var r=n(0),a=n(319),o=n.n(a),i=(n(1477),n(31)),c=n.n(i);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=function(e){var t,n;function a(t){var n;return(n=e.call(this,t)||this)._containerWidth=0,n._scrollWidth=0,n.computeMeasurements=function(){n._tabListRef&&(n._containerWidth=n._tabListRef.offsetWidth,n._scrollWidth=n._tabListRef.scrollWidth)},n.postHeaderUpdate=function(){var e=n.props.activeIndex;n.computeMeasurements(),n.slideIntoView(e)},n.handleTabHeaderClick=function(e){var t=n.props.changeActiveTab;t&&"function"==typeof t&&t(e)},n.slideIntoView=function(e){var t=n._tabRefs[e],r=n._tabWrapperRef;if(t&&r&&!(n._scrollWidth-n._containerWidth<0)){var a=r.scrollLeft||0,o=t.offsetLeft-a,i=t.offsetWidth,c=o-(n._containerWidth-i)/2;a+c<0?c=-a:a+c>n._scrollWidth-n._containerWidth&&(c=n._scrollWidth-n._containerWidth-a),n.cssScrolling(c,t)}},n.cssScrolling=function(e,t){var r=n._tabListRef,a=n._tabWrapperRef,o=n._indicatorRef;if(r&&a&&o){var i=n.props.transitionConfig,c=i.duration,s=i.easeFunction,l=i.delay;r.style.transition="transform "+c+" "+s+" "+l,r.style.transform="translateX("+-e+"px)",o.style.transition="transform "+c+" "+s+" "+l,o.style.transform="translateX("+(t.offsetLeft-e)+"px)",o.style.width=t.clientWidth+"px",n._transitionEndHandler&&r.removeEventListener("transitionend",n._transitionEndHandler),n._transitionEndHandler=function(){n.restoreScrollPosition(t,(a.scrollLeft||0)+e),r.removeEventListener("transitionend",n._transitionEndHandler),n._transitionEndHandler=null},r.addEventListener("transitionend",n._transitionEndHandler)}},n.restoreScrollPosition=function(e,t){var r=n._tabListRef,a=n._indicatorRef;r&&a&&(r.style.transition="transform 0s",r.style.transform="",a.style.transition="transform 0s",a.style.transform="translateX("+e.offsetLeft+"px)",n.scrollTo(t))},n.scrollTo=function(e){requestAnimationFrame(function(){n._tabWrapperRef&&("function"==typeof n._tabWrapperRef.scrollTo?n._tabWrapperRef.scrollTo(e,0):(n._tabWrapperRef.scrollLeft=e,n._tabWrapperRef.scrollTop=0))})},n.indicatorStyle=function(e){var t=n.props,r=t.activeIndex,a=t.headerScrollable,o=t.underlineActiveTab,i=n._tabRefs&&n._tabRefs[r],c={display:o?"block":"none"};return a||(c.width=i?i.clientWidth+"px":100/e+"%",c.transform=i?"translateX("+i.offsetLeft+"px)":"translateX("+100*r+"%)"),c},n._tabRefs=[],n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.componentDidMount=function(){var e=this.props,t=e.headerScrollable,n=e.activeIndex;t&&(this.computeMeasurements(),this.slideIntoView(n))},o.componentDidUpdate=function(e){var t=this.props,n=t.headerScrollable,r=t.activeIndex,a=t.header,o=e.headerScrollable,i=e.activeIndex,c=e.header;n&&(a!==c||a.length!==c.length?requestAnimationFrame(this.postHeaderUpdate):o&&r===i||this.slideIntoView(r))},o.render=function(){var e=this,t=this.props,n=t.headerTop,a=t.header,o=t.activeIndex,i=t.theme,l=t.headerStyle,u=void 0===l?{}:l,f=t.headerScrollable,d=a.filter(function(e){return null!=e}),p=d.length;return r.createElement("nav",{className:c()("stardust-tabs-header-wrapper",f?"stardust-tabs-header-wrapper--scrollable":""),style:s({},u,{top:n}),ref:function(t){return e._tabWrapperRef=t}},r.createElement("ul",{className:c()("stardust-tabs-header",{"stardust-tabs-header--light":"light"===i}),ref:function(t){return e._tabListRef=t}},d.map(function(t,n){return r.createElement("li",{className:c()("stardust-tabs-header__tab",{"stardust-tabs-header__tab--active":o===n}),onClick:function(){return e.handleTabHeaderClick(n)},key:n,ref:function(t){return e._tabRefs[n]=t}},t)})),r.createElement("i",{style:this.indicatorStyle(p),ref:function(t){return e._indicatorRef=t},className:"stardust-tabs-header__tab-indicator"}))},a}(r.Component);function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}l.defaultProps={transitionConfig:{duration:"0.5s",easeFunction:"cubic-bezier(0.15, 0.3, 0.25, 1)",delay:"0s"}};var f=function(e){var t,n;function a(t){var n;return n=e.call(this,t)||this,o()(t.header&&Array.isArray(t.header),"stardust-tabs-container: must pass in an array of ReactElement for the header props"),o()(t.children&&r.Children.count(t.children)===t.header.length,"stardust-tabs-container: tab panels must be equal to the tab headers"),n.state={activeIndex:t.activeIndex,scrollPositions:new Array(t.header.length).fill(0)},n._tabsHeaderAnchorRef=null,n.setTabsHeaderAnchorRef=n.setTabsHeaderAnchorRef.bind(u(u(n))),n.changeActiveTab=n.changeActiveTab.bind(u(u(n))),n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=a.prototype;return i.UNSAFE_componentWillReceiveProps=function(e){e.activeIndex!==this.props.activeIndex&&e.activeIndex!==this.state.activeIndex&&this.changeActiveTab(e.activeIndex,!0)},i.componentDidUpdate=function(e){this.updateScrollPositionStateOnUpdate(e.header,this.props.header)},i.updateScrollPositionStateOnUpdate=function(e,t){if(e.length!==t.length){var n=this.state.scrollPositions;this.setState({scrollPositions:Array.from({length:t.length},function(e,t){return n[t]||0})})}},i.setTabsHeaderAnchorRef=function(e){e&&(this._tabsHeaderAnchorRef=e)},i.changeActiveTab=function(e,t){var n=this;if(void 0===t&&(t=!1),(t||!this.props.shouldStopChangeTab||"function"!=typeof this.props.shouldStopChangeTab||!this.props.shouldStopChangeTab(e))&&this._tabsHeaderAnchorRef){var r=function(e){for(var t=0,n=e;n&&n.offsetParent;)"number"==typeof n.offsetTop&&(t+=n.offsetTop),n=n.offsetParent;return t}(this._tabsHeaderAnchorRef)-this.props.headerTop,a=window&&window.scrollY?window.scrollY:0,o=a>=r,i=o?r:a;this.setState({activeIndex:e,scrollPositions:this.state.scrollPositions.map(function(e,t){return o?t===n.state.activeIndex?n.props.scrollTabToTop?0:a-r:e:0})},function(){n.props.onChangeTab&&"function"==typeof n.props.onChangeTab&&n.props.onChangeTab(e);var t=i+n.state.scrollPositions[e];window&&window.scrollTo&&window.scrollTo(window.scrollX,t)})}},i.render=function(){var e=this.props,t=e.header,n=e.headerTop,a=e.children,o=e.theme,i=e.underlineActiveTab,c=e.className,s=e.headerStyle,u=e.headerScrollable,f=e.toRem,d=this.state.activeIndex;return r.createElement("div",{className:c},r.createElement("div",{className:"stardust-tabs-header-anchor",ref:this.setTabsHeaderAnchorRef}),t?r.createElement(l,{activeIndex:d,headerTop:f?f(n):n,changeActiveTab:this.changeActiveTab,header:t,theme:o,underlineActiveTab:i,headerStyle:s,headerScrollable:!!u}):null,r.createElement("div",{className:"stardust-tabs-panels"},r.Children.map(a,function(e,t){return r.createElement("section",{className:"stardust-tabs-panels__panel",style:{display:t!==d?"none":"block"},key:t},e)})))},a}(r.Component);f.defaultProps={headerTop:0,activeIndex:0,theme:"dark",headerScrollable:!1},n.d(t,"a",function(){return f})},1477:function(e,t,n){},1520:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return c});var r=n(1),a=Object(r.b)("FETCH_DAILY_DISCOVER_TAB_CONFIG"),o=Object(r.b)("FETCH_DAILY_DISCOVER_PERSONALIZED_TABS"),i=Object(r.b)("FETCH_DAILY_DISCOVER_COLLECTIONS"),c=Object(r.b)("FETCH_DAILY_DISCOVER_TOP_PRODUCTS")},1521:function(e,t){},1522:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r,a=n(21),o=n(1520),i=n(9),c=n(6);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=Object(a.a)(((r={})[o.c.REQUESTED]=function(e){return s({},e,{tabConfig:s({},e.tabConfig,{fetchStatus:i.b.REQ,error:0})})},r[o.c.SUCCESS]=function(e,t){return s({},e,{tabConfig:{config:t.data,fetchStatus:i.b.OK,error:0}})},r[o.c.FAILED]=function(e,t){return s({},e,{tabConfig:{config:s({all:{},campaign:[]},Object(c.a)(e,["tabConfig","config"])),fetchStatus:i.b.ERR,error:t.data}})},r[o.b.REQUESTED]=function(e){return s({},e,{personalizedTabs:s({},e.personalizedTabs,{loading:!0,error:0})})},r[o.b.SUCCESS]=function(e,t){return s({},e,{personalizedTabs:{loading:!1,error:0,categories:t.data}})},r[o.b.FAILED]=function(e,t){return s({},e,{personalizedTabs:{loading:!1,error:t.data,categories:[]}})},r[o.a.REQUESTED]=function(e){return s({},e,{collections:[]})},r[o.a.SUCCESS]=function(e,t){return s({},e,{collections:t.data})},r[o.d.REQUESTED]=function(e){return s({},e,{topProducts:[]})},r[o.d.SUCCESS]=function(e,t){return s({},e,{topProducts:t.data})},r),{})},1523:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c});var r=n(6),a=n(9);function o(e){return Object(r.a)(e,["tabConfig","fetchStatus"],a.b.INIT)}function i(e){return Object(r.a)(e,["tabConfig","config","all"])}function c(e){var t=function(e){return Object(r.a)(e,["tabConfig","config","campaign"])}(e);return t?t[0]:void 0}},1546:function(e,t,n){"use strict";var r=n(29),a=n(6);function o(e){return e?{name:e.display_text,color:e.text_color,imageForPC:e.pc_image,imageForApp:e.tab_image,label:e.product_label,recommendType:e.algo_type||0}:{}}var i=n(3);n(1401);var c=n(1520);function s(e){var t=e.shouldSkipCall;return Object(r.a)({apiCall:function(){return Object(i.d)("/api/v2/cms/daily_discover_config")},actions:[function(){return{type:c.c.REQUESTED}},function(e,t){var n=Object(a.a)(t,["data","all_tab_config"]),r=Object(a.a)(t,["data","campaign_tabs"],[]);return{type:c.c.SUCCESS,data:{all:o(n),campaign:r.map(function(e){return o(e)})}}},function(e,t){return{type:c.c.FAILED,data:t.error}}],shouldSkipCall:function(e){return"function"==typeof t&&t(e)}})}n.d(t,"a",function(){return s})},1765:function(e,t,n){"use strict";var r=n(1546);n.d(t,"fetchTabConfig",function(){return r.a});var a=n(1521);n.o(a,"dailyDiscoverReducer")&&n.d(t,"dailyDiscoverReducer",function(){return a.dailyDiscoverReducer}),n.o(a,"getAllTabConfig")&&n.d(t,"getAllTabConfig",function(){return a.getAllTabConfig}),n.o(a,"getFirstCampaignTabConfig")&&n.d(t,"getFirstCampaignTabConfig",function(){return a.getFirstCampaignTabConfig}),n.o(a,"getTabConfigFetchStatus")&&n.d(t,"getTabConfigFetchStatus",function(){return a.getTabConfigFetchStatus});var o=n(1522);n.d(t,"dailyDiscoverReducer",function(){return o.a});n(1401);var i=n(1523);n.d(t,"getAllTabConfig",function(){return i.a}),n.d(t,"getFirstCampaignTabConfig",function(){return i.b}),n.d(t,"getTabConfigFetchStatus",function(){return i.c})},3167:function(e,t,n){e.exports={tab:"BBcFUz",activeIndicator:"BFqev7",logo:"_1eqU0X"}},3168:function(e,t,n){e.exports={container:"_2xGR3B",activeIndicator:"_1Z8VkJ",spinner:"_2Il3N3"}},3473:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(52),o=n(60),i=n(1454),c=n(31),s=n.n(c),l=n(1031),u=n(459),f=n(81),d=n(390),p=n(402),h=n(3167),b=n.n(h);var m=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.shouldComponentUpdate=function(e){return Object(d.a)(this.props,e,["recommendType","customTextColor","customHeaderImage","indicatorClassName"])},o.render=function(){var e=this.props,t=e.customTextColor,n=e.customHeaderImage,a=e.indicatorClassName,o=e.trackingClick;return r.createElement(r.Fragment,null,r.createElement("div",{className:s()(b.a.activeIndicator,a||""),style:t?{background:t}:null}),r.createElement("div",{className:b.a.tab,onClick:o},r.createElement(l.a,{headerText:Object(f.t)("label_daily_discover"),customHeader:{color:t,image:n,display_height:p.l.DAILY_DISCOVER_TAB_IMAGE_HEIGHT}})))},a}(r.Component),v=Object(u.a)(m,"HomeRecommendTab"),g=n(923),_=n(848),C=n(117),T=n(919),y=n(132),E=n(224),S=n(6),I=n(320),R=n(9),A=n(409),O=n(920),D=n(330),j=n(53),w=n(255),L=n(1765),x=n(921),F=n(177),P=n(3168),H=n.n(P);function N(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function U(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){N(o,r,a,i,c,"next",e)}function c(e){N(o,r,a,i,c,"throw",e)}i(void 0)})}}var W=118,k=Object(T.a)({loader:function(){return Promise.all([n.e(3),n.e(4),n.e(5),n.e(6),n.e(79)]).then(n.bind(null,3475))}}),B=Object(T.a)({loader:function(){return Promise.all([n.e(3),n.e(13),n.e(83)]).then(n.bind(null,3389))}}),V=Object(T.a)({loader:function(){return Promise.all([n.e(3),n.e(13),n.e(78)]).then(n.bind(null,3390))}}),Y=Object(T.a)({loader:function(){return Promise.all([n.e(3),n.e(13),n.e(77)]).then(n.bind(null,3391))}}),G=function(e){var t,n;function a(t){var n;return(n=e.call(this,t)||this).handleChangeTab=function(e){n.setState({activeTab:e},function(){if(n._ref){var e=Object(y.c)(n._ref).top-W;e<window.pageYOffset&&window.scroll(0,e)}})},n.getRef=function(e){e&&(n._ref=e)},n.loadDailyDiscoverConfig=U(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.injectAsyncReducer({dailyDiscoverConfig:L.dailyDiscoverReducer}),e.next=3,n.props.fetchTabConfig({shouldSkipCall:function(e){return Object(L.getTabConfigFetchStatus)(e.dailyDiscoverConfig)===R.b.OK}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)})),n.universalDataFetch=U(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadDailyDiscoverConfig();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),n.state={activeTab:0},n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.UNSAFE_componentWillMount=function(){this.loadDailyDiscoverConfig()},o.shouldComponentUpdate=function(e,t){return e.customHeader!==this.props.customHeader||e.dailyDiscoverConfig!==this.props.dailyDiscoverConfig||e.account!==this.props.account||t.activeTab!==this.state.activeTab},o.getTabs=function(){var e=this.props,t=e.allTabConfig,n=e.campaignTabConfig;return t&&n?[A.a.DAILY_DISCOVER,n.recommendType].map(function(e){var a=t.color,o=null;return n&&e!==A.a.DAILY_DISCOVER&&(a=n.color||a,o=n.imageForPC||o),r.createElement(v,{key:e,recommendType:e,customTextColor:a,customHeaderImage:o,indicatorClassName:H.a.activeIndicator})}):[]},o.getContents=function(){var e=this.state.activeTab,t=this.props,n=t.campaignTabConfig,a=t.isBff;if(!n)return[];var o=Object(I.a)(this.props.account.toJS(),j.a,__LOCALE__).isUserAdult;return[A.a.DAILY_DISCOVER,n.recommendType].map(function(t,i){if(i!==e)return null;if(null===a)return r.createElement(g.a,{show:!0,hideOverlay:!0,spinnerClassName:H.a.spinner});var c=n&&n.label||0;if(0===i)return r.createElement(V,{key:t,recommendType:t,tabId:i,isUserAdult:o,isBff:a});if(n.recommendType===A.a.BIG_SALE_11_11&&c)return r.createElement(Y,{key:t,recommendType:t,labelId:c,tabId:i,isUserAdult:o,isBff:a});if(n.recommendType!==A.a.BIG_SALE_11_11){var s=c?[c]:null;return r.createElement(B,{key:t,recommendType:t,labelIds:s,tabId:i,isUserAdult:o})}return null})},o.render=function(){var e=this.props,t=e.campaignTabConfig,n=e.tabConfigFetchStatus,a=e.isBff;if(M.includes(n))return r.createElement(g.a,{show:!0,hideOverlay:!0,spinnerClassName:H.a.spinner});if(t&&["imageForPC","name"].every(function(e){return t[e]})&&(t.recommendType!==A.a.BIG_SALE_11_11||!!t.label))return r.createElement("div",{ref:this.getRef},r.createElement(i.a,{header:this.getTabs(),className:H.a.container,headerTop:W,activeIndex:this.state.activeTab,onChangeTab:this.handleChangeTab,toRem:E.a},this.getContents()));var o=Object(S.a)(this.props.customHeader,[D.a.DAILY_DISCOVER,"color"]);return r.createElement(k,{headerColor:o,isBff:a})},a}(r.Component),M=[R.b.INIT,R.b.REQ];t.default=Object(o.d)(_.b,w.b,Object(a.connect)(function(e){var t=e.dailyDiscoverConfig,n=e.featureToggles;return{dailyDiscoverConfig:t,allTabConfig:Object(L.getAllTabConfig)(t),campaignTabConfig:Object(L.getFirstCampaignTabConfig)(t),tabConfigFetchStatus:Object(L.getTabConfigFetchStatus)(t),isBff:Object(x.a)(n,O.a.DAILY_DISCOVER_BFF_API,null),account:Object(F.getAccountStore)(e)}},{fetchTabConfig:L.fetchTabConfig}),Object(f.withI18nCollections)([119,120]))(Object(C.e)(G,"HomeDailyDiscover"))}}]);
//# sourceMappingURL=https://shopee.sg/assets/HomeDailyDiscover.f2e9e3ec9066ca3db98f.js.map